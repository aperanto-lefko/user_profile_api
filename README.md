# UserProfileAPI REST API (Spring Boot)

REST API для управления пользовательскими профилями с возможностью аутентификации и хранения контактных данных.


### 1. Аутентификация (*)
Реализована авторизация по логину и паролю (admin:admin)  
**Выбранный тип:** JWT (JSON Web Tokens)  
**Обоснование выбора:**
- Более безопасный вариант по сравнению с Basic Auth
- Не требует постоянного обмена credentials
- Стандартный подход для современных REST API
- Легко масштабируется

### 2. CRUD для контактной информации пользователей
Реализованы операции:
- Создание пользователя (POST)
- Получение информации о пользователе (GET)
- Обновление данных (PUT/PATCH)
- Удаление пользователя (DELETE)

### 3. CRUD для детальной информации о пользователе
Дополнительные операции для расширенных данных:
- Добавление/изменение дополнительных полей
- Валидация данных
- Связь с основной учетной записью

### 4. Работа с фотографиями пользователя (*)
Реализовано:
- Загрузка фотографии (POST)
- Получение фотографии (GET)
- Обновление (PUT)
- Удаление (DELETE)
- Хранение в файловой системе/БД

## Технологический стек

- **Язык:** Java 17
- **Фреймворк:** Spring Boot 3.x
- **База данных:** PostgreSQL
- **ORM:** Hibernate
- **Аутентификация:** Spring Security + JWT
- **Тестирование:** JUnit 5, Mockito
- **Сборка:** Maven

## Системные компоненты

### Бизнес-микросервисы:
- **Auth Service** - управление пользователями и аутентификацией
- **User Service** - управление пользователями и личными данными
- **Gateway Service** - единая точка входа для API

### Инфраструктурные сервисы:
- **Config Server** - централизованное хранение конфигураций
- **Eureka Server** - сервис обнаружения и регистрации микросервисов

### Стек технологий
- Spring Boot 3.x
- Spring Cloud Gateway
- Eureka Service Discovery
- Feign Client
- Docker + Docker Compose

Сервисы зарегистрированы в **Eureka Server** и используют:
- Централизованную конфигурацию
- Service discovery через Eureka
- Feign клиенты для межсервисного взаимодействия

## API Endpoints

### Auth Service (`/api/auth`)

| Метод | Эндпоинт          | Описание                                                            |
|-------|-------------------|---------------------------------------------------------------------|
| POST | `/register`       | Регистрация нового пользователя                                     |
| POST | `/token`          | Аутентификация пользователя (получение токена)                      |
| GET | `/users/{userId}` | Получение информации о пользователе (для внутреннего использования) |



   
## Docker развертывание

1. Собрать и запустить все сервисы:
```bash
docker compose build --no-cache && docker compose up
```

### Порядок запуска локально
  - Развернуть базы в docker (compose.yaml)
  - DiscoveryServer
  - ConfigServer
  - GatewayService

далее (после паузы)
   - AuthService
   - UserService

#### Особенности запуска

Для локального запуска из IDE после развертывания баз в docker в модуле config-server перед запуском следует 
раскомментировать строки в application.yaml: url: jdbc:postgresql://user-db:5432/user-db для user-service и
url: jdbc:postgresql://auth-db:5432/auth-db для auth-service

### Для тестирования

В первую очередь производится регистрация в auth-service (логин, пароль), затем добавление данных в user service
